<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>Webmapp 201</title>
        <link rel="stylesheet" href="src/leaflet.css">
        <link rel="stylesheet" href="src/css/bootstrap.css">
        <link rel="stylesheet" href="src/plugins/L.Control.Zoomslider.css">
        <link rel="stylesheet" href="src/plugins/L.Control.Sidebar.css">
        <link rel="stylesheet" href="dist/MarkerCluster.css">
        <link rel="stylesheet" href="dist/MarkerCluster.Default.css">
        <link rel="stylesheet" href="https://ppete2.github.io/Leaflet.PolylineMeasure/Leaflet.PolylineMeasure.css" />

        
        
        <script src="src/leaflet-src.js"></script>
        <script src="src/jquery-3.6.0.min.js"></script>
        <script src="src/turf.min.js" charset="utf-8"></script>
        <script src="src/plugins/L.Control.Zoomslider.js"></script>
        <script src="src/plugins/L.Control.Sidebar.js"></script>
        <script src='swedish_counties.js'></script>
        <script src='countries.js'></script>
        <script src="https://ppete2.github.io/Leaflet.PolylineMeasure/Leaflet.PolylineMeasure.js"></script>

        
        
        
       
        
        <style>
            #mapdiv {
                height: 100vh;
            }  
            
            #side-bar {
			position: absolute;
			z-index: 1000;
			background: rgba(255,255,255,0.7);
			padding: 10px;
			right: 0;
            top: 0;
			margin: 10px;
			border-radius: 10px;
			min-height: 200px;
            }
                        
        </style>
    </head>
    <body>
       <div id="mapdiv" class="col-md-9"></div>
       
       <div id="side-bar" class="col-md-3"><h2>My Map</h2>
            <button id="l1">layer1</button>
            <button id="l2">layer2</button>
            <button id='btnFalun' class='btn btn-primary btn-block'>ZoomToFalun</button>
            <button id="t2">Task2</button>
  
       </div>
       
       <div id="sidebar"><h1>leaflet-sidebar123</h1>
        <ul>
            <li>
                <h3>Söderbaumskaskolan</h3>
                <p>År 2001 grundades Söderbaumska skolan som en fristående grundskola med en kulturprofil. I oktober 2021 bytte skolan namn till Innovitaskolan Falun i samband med en ny skolprofilering inom AcadeMedia-koncernen.</p>
                <p>Antal elever: 550</p>
                <button id="btns1">Go to Söderbaumskaskolan</button>
            </li>
            <li>
                <h3>Britsarvsskolan</h3>
                <p>​Britsarvsskolan i Falun började byggas 1964 på platsen där gården Bojsenburg tidigare låg, och stod klar 1966 som en toppmodern skola ritad av arkitekt Jack Hansson. </p>
                <p>Antal elever: 530</p>
                <button id="btns2">Go to Britsarvsskolan</button>
            </li>
            <li> 
                <h3>Hälsinggårdsskolan</h3>
                <p>Idag är Hälsinggårdsskolan en F-9-skola med cirka 700 elever, känd för sitt inkluderande och mångkulturella perspektiv. För närvarande genomgår skolan en omfattande renovering för att modernisera lokalerna och samlokalisera kommunens särskolor, med planerad färdigställning 2025.</p>
                <p>Antal elever: 600</p>
                <button id="btns3">Go to Hälsinggårdsskolan</button>
            </li>
            <li> 
                <h3>VästraSkolan</h3>
                <p>​Västra skolan i Falun invigdes 1915 för att avlasta den då överbelastade Östra skolan. Byggnaden ritades av stadsarkitekten Klas Boman och har tjänat som utbildningsinstitution i över ett sekel.</p>
                <p>Antal elever: 470</p>
                <button id="btns4">Go to VästraSkolan</button>
            </li>
            <li>
                <h3>Mosaik</h3>
                <p>Friskolan Mosaik i Falun grundades 2007 och drivs som en fristående ekonomisk förening. Skolan är belägen på Vasagatan 28 i centrala Falun och erbjuder undervisning från förskoleklass till årskurs 9.</p>
                <p>Antal elever: 270</p>
                <button id="btns5">Go to Mosaik</button>
            </li>
        </ul>

       </div>
        
       <script>
            var mymap; 
            var lyrOSM; 
            var mrkCurrentLocation;
            var ctlZoomslider;
            var swedishlayer = L.geoJson(swedish_counties);
            var countrieslayer
            var ctlSlidebar;
            var sample = L.geoJson(sample);
            var sample1 = L.geoJson(sample1);
            
           
            $(document).ready(function(){
                mymap = L.map('mapdiv', {center:[60.48868922712431, 15.421371459960938], zoom:13});
                lyrOSM= L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png');
                mymap.addLayer(lyrOSM);

 
                ctlZoomslider = L.control.zoomslider({position:'topright'}).addTo(mymap);
                
                var sidebar = L.control.sidebar('sidebar', {position: 'left'});
                mymap.addControl(sidebar);
                
                var latlngs = [
					[60.482370725338484, 15.434717248972277],
					[60.484316080102275, 15.441777259162706],
					[60.486972387134756, 15.438435413671698]
				];

				var polyline = L.polyline(latlngs, {color: 'red'}).addTo(mymap);

                L.control.polylineMeasure().addTo(mymap);

                    let polylineMeasure = L.control.polylineMeasure({
                        position: 'topleft',
                        unit: 'kilometres',
                        showBearings: true,
                        clearMeasurementsOnStop: false,
                        showClearControl: true,
                        showUnitControl: true
                    }).addTo(mymap);

                    const school1Coords = [
                        
                            { lat: 60.61668314092263, lng: 15.627644549953436 },
                            { lat: 60.625256903746184, lng: 15.622433198014082 },
                            { lat: 60.592595759762666, lng: 15.685269813355674 },
                            { lat: 60.604365663833036, lng: 15.624258467326692 },
                            { lat: 60.60984456541524, lng: 15.638397283032829 }

                        
                    ];

                

                               
                                      
                var blackIcon = L.icon({
                    iconUrl: 'map-marker.svg',
                    iconSize:     [32, 37], // size of the icon
                    iconAnchor:   [32, 37], // point of the icon which will correspond to marker's location
                    popupAnchor:  [0, -30] // point from which the popup should open relative to the iconAnchor
                });
                //Koden är till markeringen för när du trycker på en plats. 
                
                // Popup and marker
                
                popb = L.marker([60.48868922712431, 15.431371459960938],{icon: blackIcon}).addTo(mymap).bindPopup('Intro to Leaflet');
                popf= L.marker([60.605898734439805,15.628023594617845], {icon:blackIcon}).addTo(mymap).bindPopup("<h3>Falun Museum</h3><img src= 'img/museum.jpg'width='150px'>")
                
                                
                document.getElementById("l1").addEventListener("click", sweden);

		          function sweden(){
                      if(mymap.hasLayer(swedishlayer)){
                          mymap.removeLayer(swedishlayer);
                         
                          sidebar.hide();
                          
                      } else {
                          swedishlayer.addTo(mymap);
                          
                          sidebar.show();
                      }
			
		          };
                
                countrieslayer = L.geoJson(countries, {
			    onEachFeature: function (feature, layer) {
				layer.bindPopup(feature.properties.name);
			     }
		         });


		      document.getElementById("l2").addEventListener("click", c_layers);
                
                function c_layers(){
                    if(mymap.hasLayer(countrieslayer)){
                        mymap.removeLayer(countrieslayer);
                    } 
                    else {
                        countrieslayer.addTo(mymap);
                        }
                    };
                
                
                
                $("#btnFalun").click(function(){
                    mymap.setView([60.605866810126194, 15.628008842468262], 17);
                })

                
                


                document.getElementById("t2").addEventListener("click", school);
                function school(){
                   

                    if(mymap.hasLayer(swedishlayer)){
                        mymap.removeLayer(swedishlayer);
                        sidebar.hide();
                        s1.remove();
                        s2.remove();
                        s3.remove();
                        s4.remove();
                        s5.remove();
                    } else {
                        swedishlayer.addTo(mymap);
                        sidebar.show();
                        s1 = L.marker([60.61668314092263, 15.627644549953436],{icon: blackIcon}).addTo(mymap).bindPopup('Söderbaumska');
                        s2 = L.marker([60.625256903746184, 15.622433198014082],{icon: blackIcon}).addTo(mymap).bindPopup('Britsarvsskolan');
                        s3 = L.marker([60.592595759762666, 15.685269813355674],{icon: blackIcon}).addTo(mymap).bindPopup('hälsinggårdsskolan');
                        s4 = L.marker([60.604365663833036, 15.624258467326692],{icon: blackIcon}).addTo(mymap).bindPopup('Västraskolan');
                        s5 = L.marker([60.60984456541524, 15.638397283032829],{icon: blackIcon}).addTo(mymap).bindPopup('Mosaik');


                        polylineMeasure.seed([school1Coords]);
                    }







                    $("#btns1").click(function(){
                    mymap.setView([60.61668314092263, 15.627644549953436], 17);
                })
                $("#btns2").click(function(){
                    mymap.setView([60.625256903746184, 15.622433198014082], 17);
                })
                $("#btns3").click(function(){
                    mymap.setView([60.592595759762666, 15.685269813355674], 17);
                })
                $("#btns4").click(function(){
                    mymap.setView([60.604365663833036, 15.624258467326692], 17);
                })
                $("#btns5").click(function(){
                    mymap.setView([60.60984456541524, 15.638397283032829], 17);
                })

                };
               




                countrieslayer = L.geoJson(countries, {
                    onEachFeature: function (feature, layer) {
                        layer.bindPopup(feature.properties.name);
                    }
                });







                // Buffer
                            
  /*              sample1.addTo(mymap);
                var s2 = sample1.toGeoJSON();
                
                var samplegeo = turf.buffer(s2, 0.5,{units: 'kilometers' });

                var samplegeol = L.geoJSON(samplegeo, {style:{color:'yellow', dashArray:'5,5', fillOpacity:0.1}}).addTo(mymap);
    */               
                    
  
            });
            
            

            
       </script>
    </body>
</html>